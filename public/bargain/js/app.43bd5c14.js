(function(t){function a(a){for(var n,r,s=a[0],c=a[1],l=a[2],d=0,g=[];d<s.length;d++)r=s[d],i[r]&&g.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(a);while(g.length)g.shift()();return o.push.apply(o,l||[]),e()}function e(){for(var t,a=0;a<o.length;a++){for(var e=o[a],n=!0,s=1;s<e.length;s++){var c=e[s];0!==i[c]&&(n=!1)}n&&(o.splice(a--,1),t=r(r.s=e[0]))}return t}var n={},i={app:0},o=[];function r(a){if(n[a])return n[a].exports;var e=n[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=t,r.c=n,r.d=function(t,a,e){r.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,a){if(1&a&&(t=r(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var n in t)r.d(e,n,function(a){return t[a]}.bind(null,n));return e},r.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(a,"a",a),a},r.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},r.p="/bargain/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=a,s=s.slice();for(var l=0;l<s.length;l++)a(s[l]);var u=c;o.push([0,"chunk-vendors"]),e()})({0:function(t,a,e){t.exports=e("56d7")},"034f":function(t,a,e){"use strict";var n=e("04f5"),i=e.n(n);i.a},"04f5":function(t,a,e){},"0970":function(t,a,e){},"0e53":function(t,a,e){"use strict";var n=e("cfca"),i=e.n(n);i.a},"13c3":function(t,a,e){"use strict";var n=e("feef"),i=e.n(n);i.a},"32f0":function(t,a,e){},"3aff":function(t,a,e){},"56d7":function(t,a,e){"use strict";e.r(a);e("cadf"),e("551c");var n=e("2b0e"),i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},o=[],r={name:"app"},s=r,c=(e("034f"),e("2877")),l=Object(c["a"])(s,i,o,!1,null,null,null),u=l.exports,d=e("8c4f"),g=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t._v("home")])},f=[],m={name:"Home",created:function(){}},h=m,p=(e("8b30"),Object(c["a"])(h,g,f,!1,null,"53b52152",null)),v=p.exports,_=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t._v("\n    "+t._s(t.message)+"\n\n    ")])},b=[],w=(e("386d"),e("3b2b"),e("4917"),e("bc3a")),y=e.n(w),k={name:"Login",data:function(){return{message:"玩命加载中。。。"}},created:function(){window.localStorage.getItem("iosurl")||window.localStorage.setItem("iosurl",1),this.isWechat()?this.login():this.message="请在微信中打开..."},methods:{isWechat:function(){var t=window.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)},login:function(){var t=this.myconf.appid,a=encodeURIComponent(window.location.href),e="https://open.weixin.qq.com/connect/oauth2/authorize?appid=".concat(t,"&redirect_uri=").concat(a,"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"),n=this.$route.query.code,i=this.$route.query.flag,o=this.$route.query.no;n?this.getToken(n,i,o):window.location.href=e},getToken:function(t,a,e){var n=this,i=this.myconf.api_host+"/bargian_api/gettoken";y.a.get(i,{params:{code:t}}).then(function(t){var i=t.data.token;i?(window.localStorage.setItem("user_token",i),"share"==a&&e?n.$router.push({name:"dobargain",query:{no:e}}):n.$router.push({name:"list"})):n.message=t.data}).catch(function(){n.$router.push({name:"list"})})},getUrlParam:function(t){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(a);return null!=e?decodeURI(e[2]):null}}},C=k,S=(e("da41"),Object(c["a"])(C,_,b,!1,null,null,null)),D=S.exports,j=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main"},[e("div",{staticClass:"banner"},[e("img",{attrs:{src:t.myconf.api_host+"/static/bargain/images/banner_01.jpg",alt:""}})]),e("div",{staticClass:"list"},[e("ul",t._l(t.listData,function(a){return e("li",{key:a.id},[e("div",{staticClass:"pic"},[e("img",{attrs:{src:t.myconf.api_host+a.img1_id,alt:""}})]),e("div",{staticClass:"info"},[e("span",[t._v("原价"+t._s(a.original_price)+"元")]),e("div",{staticClass:"btn",on:{click:function(e){t.startBargain(a.id)}}},[t._v("发起砍价")])])])}))]),t._m(0)])},I=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"rules"},[e("fieldset",[e("legend",[t._v("活动规则：")]),e("ul",[e("li",[t._v("1.选择砍价商品，点按钮“发起砍价”参加活动；")]),e("li",[t._v("2.进入商品页面，点击右上角分享出去邀请朋友来为自己砍价；")]),e("li",[t._v("3.砍价时间为期5天；")]),e("li",[t._v("4.砍价时间结束后即可到店享受当前价格；")]),e("li",[t._v("5.兑换地址：锦江区东大街紫东楼35号明宇金融广场25楼。")])])])])}],O={name:"List",data:function(){return{listData:null}},created:function(){this.getList()},methods:{getList:function(){var t=this;y.a.get(this.myconf.api_host+"/bargian_api/goods").then(function(a){t.listData=a.data}).catch(function(t){window.console.log(t)})},startBargain:function(t){var a=this;y()({method:"POST",url:this.myconf.api_host+"/bargian_api/createbargain",headers:{Authorization:window.localStorage.getItem("user_token")},data:{goods_id:t}}).then(function(t){var a=t.data.bargainSn;a?window.location.href="/bargain/detail?no="+a:alert("发生错误")}).catch(function(t){var e=t.response.data;"token已过期或无效token"==e.msg?(window.localStorage.removeItem("user_token"),a.$router.push({name:"login"})):alert(t.response.data.msg)})}}},$=O,x=(e("13c3"),Object(c["a"])($,j,I,!1,null,"ecc55566",null)),T=x.exports,E=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.bargainData.goods?e("div",{staticClass:"main"},[e("div",{staticClass:"banner"},[e("img",{attrs:{src:t.myconf.api_host+t.bargainData.goods.img2_id,alt:""}})]),e("div",{staticClass:"tit-wrap"},[e("span",{staticClass:"tit"},[t._v(t._s(t.bargainData.goods.goods_name))])]),e("div",{staticClass:"sharebtn",on:{click:t.share}},[t._v("召唤好友帮忙砍价")]),e("div",{staticClass:"des",domProps:{innerHTML:t._s(t.bargainData.goods.goods_desc)}}),e("div",{staticClass:"sharebtn",on:{click:t.share}},[t._v("召唤好友帮忙砍价")]),e("div",{staticClass:"price"},[t._v("原价:￥"+t._s(t.bargainData.goods.original_price))]),e("footer",[e("router-link",{attrs:{to:"/bargain/list"}},[t._v("活动商品")]),e("router-link",{attrs:{to:{name:"mybargain"}}},[t._v("我的砍价")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.guideShow,expression:"guideShow"}],attrs:{id:"mcover"},on:{click:t.hideCover}},[e("img",{attrs:{src:t.myconf.api_host+"/static/bargain/images/guide.png?v=1"}})])]):t._e()},q=[],M=(e("28a5"),e("18a0")),P=e.n(M),A={name:"GoodsDetail",data:function(){return{bargainData:{},images:{},configData:[],guideShow:!1}},created:function(){window.localStorage.getItem("iosurl")&&(window.localStorage.removeItem("iosurl"),window.location=window.location)},mounted:function(){this.getDetail()},methods:{getDetail:function(){var t=this,a=this.$route.query.no;y()({method:"GET",url:this.myconf.api_host+"/bargian_api/bargaindetail",params:{no:a}}).then(function(a){t.bargainData=a.data}).then(function(){t.getWxShareParams()}).catch(function(t){alert("用户身份校验失败，请刷新后再分享"+t)})},getWxShareParams:function(){var t=this,a=encodeURIComponent(window.location.href.split("#")[0]);y()({method:"get",url:this.myconf.api_host+"/bargian_api/wxshare",params:{currentUrl:a}}).then(function(a){var e=a.data;t.configData=e,t.wxInit(e)})},wxInit:function(t){var a=this.$route.query.no,e=window.location.protocol+"//"+window.location.host+"/bargain/login?flag=share&no="+a,n=this.bargainData.goods.goods_name,i="砍价活动进行中,快来帮帮TA砍一刀吧！",o=this.myconf.api_host+this.bargainData.goods.img1_id;P.a.config({debug:!1,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"]}),P.a.ready(function(){P.a.onMenuShareTimeline({title:n,desc:i,link:e,imgUrl:o,success:function(){alert("分享到朋友圈成功")},cancel:function(){alert("分享失败,您取消了分享!")}}),P.a.onMenuShareAppMessage({title:n,desc:i,link:e,imgUrl:o,success:function(){alert("成功分享给朋友")},cancel:function(){alert("分享失败,您取消了分享!")}})}),P.a.error(function(t){alert(t.errMsg+"用户身份校验失败，请刷新后再分享")})},share:function(){this.guideShow=!0},hideCover:function(){this.guideShow=!1}}},R=A,B=(e("9401"),Object(c["a"])(R,E,q,!1,null,"53f09419",null)),L=B.exports,U=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.bargainData.goods?e("div",{staticClass:"main"},[e("div",{staticClass:"banner"},[e("img",{attrs:{src:t.myconf.api_host+t.bargainData.goods.img2_id,alt:""}})]),e("div",{staticClass:"tit-wrap"},[e("span",{staticClass:"tit"},[t._v(t._s(t.bargainData.goods.goods_name))])]),e("div",{staticClass:"des",domProps:{innerHTML:t._s(t.bargainData.goods.goods_desc)}}),t.kjmoney?e("div",{staticClass:"bargian-monry"},[t._v("我帮TA砍了："+t._s(t.kjmoney)+"元")]):t._e(),e("div",{staticClass:"price"},[t._v("原价:￥"+t._s(t.bargainData.goods.original_price))]),e("footer",[e("div",{staticClass:"div",on:{click:t.meto}},[t._v("我也要参加")]),e("div",{staticClass:"sharebtn",on:{click:t.doBargain}},[t._v("帮TA砍一刀")])])]):t._e()},z=[],G={name:"Dobargain",data:function(){return{no:"",bargainData:{},bargainRresult:null,kjmoney:0}},created:function(){this.getBargain()},methods:{getBargain:function(){var t=this,a=this.$route.query.no;this.no=a;var e=window.localStorage.getItem(a);e&&(this.kjmoney=e),y()({method:"GET",url:this.myconf.api_host+"/bargian_api/bargaindetail",params:{no:a}}).then(function(a){var e=a.data;window.console.log(e),t.bargainData=e}).catch(function(a){alert(a.response.data.msg),t.$router.push({name:"list"})})},doBargain:function(){var t=this,a=this.no;y()({method:"POST",url:this.myconf.api_host+"/bargian_api/dobargain",headers:{Authorization:window.localStorage.getItem("user_token")},data:{no:a}}).then(function(e){var n=e.data;window.localStorage.setItem(a,n.kjmoney),t.kjmoney=n.kjmoney,alert("您成功帮你的好友砍了"+n.kjmoney+"元!")}).catch(function(a){var e=a.response.data.msg;"token已过期或无效token"==e?(window.localStorage.removeItem("user_token"),t.$router.push({name:"login",query:{flag:"share",no:t.no}})):"token已过期或无效token"!=e?alert(e):alert("发生错误")})},meto:function(){this.$router.push({name:"list"})}}},W=G,H=(e("af3d"),Object(c["a"])(W,U,z,!1,null,"7bda8ff9",null)),J=H.exports,N=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main"},[e("ul",{staticClass:"list"},t._l(t.bargainOrdersData,function(a){return e("li",{key:a.id},[e("div",{staticClass:"goods-info"},[e("div",{staticClass:"pic"},[e("img",{attrs:{src:t.myconf.api_host+a.goods.img1_id,alt:""}})]),e("div",{staticClass:"info"},[e("p",{staticClass:"goods-name"},[t._v(t._s(a.goods.goods_name)),e("span",[t._v("(￥"+t._s(a.goods.original_price)+")")])]),e("div",{staticClass:"old-price"},[t._v("当前价：￥"+t._s(a.goods.original_price-a.helpers_sum))]),e("div",{staticClass:"order-sn"},[t._v("单号："+t._s(a.bargain_sn))]),e("div",[e("countdown",{attrs:{endtime:a.over_time}})],1),e("div",{staticClass:"btns"},[e("div",{staticClass:"link",on:{click:function(e){t.showRecord(a.bargain_sn)}}},[t._v("查看记录")]),new Date(a.over_time)-Date.parse(new Date)>0?e("router-link",{staticClass:"link",attrs:{to:{path:"/bargain/detail",query:{no:a.bargain_sn}}}},[t._v("继续砍价")]):e("div",{staticClass:"link over-link"},[t._v("当前砍价已结束")])],1)])]),e("transition",{attrs:{name:"fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.flag&&t.isShowRecord==a.bargain_sn,expression:"flag && isShowRecord==order.bargain_sn"}],staticClass:"record"},[e("ul",t._l(a.helpers,function(a){return e("li",{key:a.id},[e("img",{attrs:{src:a.user.headimgurl,alt:""}}),e("p",[t._v(t._s(a.user.nickname))]),e("span",[t._v(t._s(a.bargain_money)+"元")])])}))])])],1)})),e("footer",[e("router-link",{attrs:{to:"/bargain/list"}},[t._v("活动商品")]),e("router-link",{attrs:{to:"/bargain/mybargain"}},[t._v("我的砍价")])],1)])},F=[],K=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("span",{staticClass:"orange"},[t._v("倒计时:"+t._s(t.time))])},Q=[],V={data:function(){return{time:""}},props:["endtime"],mounted:function(){var t=this;this._interval=setInterval(function(){t.timeDown()},1e3)},destroyed:function(){clearInterval(this._interval)},methods:{timeDown:function(){var t=new Date(this.endtime)-Date.parse(new Date),a=parseInt(t/1e3/60/60/24),e=parseInt(t/1e3/60/60%24),n=parseInt(t/1e3/60%60),i=parseInt(t/1e3%60);e=e>9?e:"0"+e,n=n>9?n:"0"+n,i=i>9?i:"0"+i,this.time=a+"天"+e+"小时"+n+"分"+i+"秒"}}},X=V,Y=(e("76fd"),Object(c["a"])(X,K,Q,!1,null,"1e022bce",null)),Z=Y.exports,tt={name:"mybargain",components:{countdown:Z},data:function(){return{bargainOrdersData:{},istimeover:null,isShowRecord:"",flag:!0}},created:function(){this.getBargainOrders(),this.istimeover=Date.parse(new Date(this.bargainOrdersData.overtime))-Date.parse(new Date)},methods:{getBargainOrders:function(){var t=this;y()({method:"GET",url:this.myconf.api_host+"/bargian_api/bargainorders",headers:{Authorization:window.localStorage.getItem("user_token")}}).then(function(a){var e=a.data;t.bargainOrdersData=e,window.console.log(e)}).catch(function(a){var e=a.response.data.msg;"token已过期或无效token"==e?(window.localStorage.removeItem("user_token"),t.$router.push({name:"login",query:{flag:"share",no:t.no}})):"token已过期或无效token"!=e?alert(e):alert("发生错误")})},showRecord:function(t){this.isShowRecord=t,this.flag=!this.flag}}},at=tt,et=(e("0e53"),Object(c["a"])(at,N,F,!1,null,"14ac1f4f",null)),nt=et.exports,it=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[t._v("c")])},ot=[],rt={created:function(){window.localStorage.clear()}},st=rt,ct=(e("97ab"),Object(c["a"])(st,it,ot,!1,null,"3d6e69eb",null)),lt=ct.exports;n["a"].use(d["a"]);var ut=new d["a"]({mode:"history",base:"/bargain/",routes:[{path:"/",component:v,meta:{title:"首页"}},{path:"/login",name:"login",component:D,meta:{title:"登录中..."}},{path:"/list",name:"list",component:T,meta:{title:"砍价商品列表"}},{path:"/detail",name:"detail",component:L,meta:{title:"分享砍价"}},{path:"/dobargain",name:"dobargain",component:J,meta:{title:"帮TA砍一刀吧！"}},{path:"/c",name:"c",component:lt,meta:{title:"c"}},{path:"/mybargain",name:"mybargain",component:nt,meta:{title:"我的砍价单"}},{path:"*",component:T,meta:{title:"成都贝臣齿科"}}]});ut.beforeEach(function(t,a,e){var n=window.localStorage.getItem("user_token");return n||"/login"==t.path?(e(),n&&"/login"==t.path&&!t.query.flag||n&&"/"==t.path?(window.console.log("to.query",JSON.stringify(t.query)),e("/list"),!1):(document.title=t.meta.title,void e())):(e("/login"),!1)});var dt=ut,gt=(e("3aff"),{api_host:"http://192.168.1.253",appid:"wx150347fed55855dd"}),ft=gt;n["a"].config.productionTip=!1,n["a"].prototype.myconf=ft,new n["a"]({router:dt,render:function(t){return t(u)}}).$mount("#app")},"76fd":function(t,a,e){"use strict";var n=e("d8b1"),i=e.n(n);i.a},"897a":function(t,a,e){},"8af4":function(t,a,e){},"8b30":function(t,a,e){"use strict";var n=e("897a"),i=e.n(n);i.a},9401:function(t,a,e){"use strict";var n=e("32f0"),i=e.n(n);i.a},"97ab":function(t,a,e){"use strict";var n=e("8af4"),i=e.n(n);i.a},af3d:function(t,a,e){"use strict";var n=e("0970"),i=e.n(n);i.a},cfca:function(t,a,e){},d8b1:function(t,a,e){},da41:function(t,a,e){"use strict";var n=e("e2a5"),i=e.n(n);i.a},e2a5:function(t,a,e){},feef:function(t,a,e){}});
//# sourceMappingURL=app.43bd5c14.js.map