(function(t){function a(a){for(var e,r,s=a[0],c=a[1],l=a[2],d=0,g=[];d<s.length;d++)r=s[d],i[r]&&g.push(i[r][0]),i[r]=0;for(e in c)Object.prototype.hasOwnProperty.call(c,e)&&(t[e]=c[e]);u&&u(a);while(g.length)g.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,a=0;a<o.length;a++){for(var n=o[a],e=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(e=!1)}e&&(o.splice(a--,1),t=r(r.s=n[0]))}return t}var e={},i={app:0},o=[];function r(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,a,n){r.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,a){if(1&a&&(t=r(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var e in t)r.d(n,e,function(a){return t[a]}.bind(null,e));return n},r.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(a,"a",a),a},r.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},r.p="/bargain/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=a,s=s.slice();for(var l=0;l<s.length;l++)a(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,a,n){t.exports=n("56d7")},"034f":function(t,a,n){"use strict";var e=n("04f5"),i=n.n(e);i.a},"04f5":function(t,a,n){},"0970":function(t,a,n){},"13c3":function(t,a,n){"use strict";var e=n("feef"),i=n.n(e);i.a},"23c1":function(t,a,n){"use strict";var e=n("41ea"),i=n.n(e);i.a},3478:function(t,a,n){},"3aff":function(t,a,n){},"41ea":function(t,a,n){},"56d7":function(t,a,n){"use strict";n.r(a);n("cadf"),n("551c");var e=n("2b0e"),i=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],r={name:"app"},s=r,c=(n("034f"),n("2877")),l=Object(c["a"])(s,i,o,!1,null,null,null),u=l.exports,d=n("8c4f"),g=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[t._v("home")])},f=[],m={name:"Home",created:function(){}},h=m,p=(n("8b30"),Object(c["a"])(h,g,f,!1,null,"53b52152",null)),v=p.exports,_=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[t._v("\n    "+t._s(t.message)+"\n\n    ")])},b=[],w=(n("386d"),n("3b2b"),n("4917"),n("bc3a")),y=n.n(w),k={name:"Login",data:function(){return{message:"玩命加载中。。。"}},created:function(){window.localStorage.getItem("iosurl")||window.localStorage.setItem("iosurl",1),this.isWechat()?this.login():this.message="请在微信中打开..."},methods:{isWechat:function(){var t=window.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)},login:function(){var t=this.myconf.appid,a=encodeURIComponent(window.location.href),n="https://open.weixin.qq.com/connect/oauth2/authorize?appid=".concat(t,"&redirect_uri=").concat(a,"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"),e=this.$route.query.code,i=this.$route.query.flag,o=this.$route.query.no;e?this.getToken(e,i,o):window.location.href=n},getToken:function(t,a,n){var e=this,i=this.myconf.api_host+"/bargian_api/gettoken";y.a.get(i,{params:{code:t}}).then(function(t){var i=t.data.token;i?(window.localStorage.setItem("user_token",i),"share"==a&&n?e.$router.push({name:"dobargain",query:{no:n}}):e.$router.push({name:"list"})):e.message=t.data}).catch(function(){e.$router.push({name:"list"})})},getUrlParam:function(t){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(a);return null!=n?decodeURI(n[2]):null}}},C=k,S=(n("da41"),Object(c["a"])(C,_,b,!1,null,null,null)),D=S.exports,j=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"main"},[n("div",{staticClass:"banner"},[n("img",{attrs:{src:t.myconf.api_host+"/static/bargain/images/banner_01.jpg",alt:""}})]),n("div",{staticClass:"list"},[n("ul",t._l(t.listData,function(a){return n("li",{key:a.id},[n("div",{staticClass:"pic"},[n("img",{attrs:{src:t.myconf.api_host+a.img1_id,alt:""}})]),n("div",{staticClass:"info"},[n("span",[t._v("原价"+t._s(a.original_price)+"元")]),n("div",{staticClass:"btn",on:{click:function(n){t.startBargain(a.id)}}},[t._v("发起砍价")])])])}))]),t._m(0)])},I=[function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"rules"},[n("fieldset",[n("legend",[t._v("活动规则：")]),n("ul",[n("li",[t._v("1.选择砍价商品，点按钮“发起砍价”参加活动；")]),n("li",[t._v("2.进入商品页面，点击右上角分享出去邀请朋友来为自己砍价；")]),n("li",[t._v("3.砍价时间为期5天；")]),n("li",[t._v("4.砍价时间结束后即可到店享受当前价格；")]),n("li",[t._v("5.兑换地址：锦江区东大街紫东楼35号明宇金融广场25楼。")])])])])}],O={name:"List",data:function(){return{listData:null}},created:function(){this.getList()},methods:{getList:function(){var t=this;y.a.get(this.myconf.api_host+"/bargian_api/goods").then(function(a){t.listData=a.data}).catch(function(t){window.console.log(t)})},startBargain:function(t){var a=this;y()({method:"POST",url:this.myconf.api_host+"/bargian_api/createbargain",headers:{Authorization:window.localStorage.getItem("user_token")},data:{goods_id:t}}).then(function(t){var a=t.data.bargainSn;a?window.location.href="/bargain/detail?no="+a:alert("发生错误")}).catch(function(t){var n=t.response.data;"token已过期或无效token"==n.msg?(window.localStorage.removeItem("user_token"),a.$router.push({name:"login"})):alert(t.response.data.msg)})}}},x=O,$=(n("13c3"),Object(c["a"])(x,j,I,!1,null,"ecc55566",null)),T=$.exports,E=function(){var t=this,a=t.$createElement,n=t._self._c||a;return t.bargainData.goods?n("div",{staticClass:"main"},[n("div",{staticClass:"banner"},[n("img",{attrs:{src:t.myconf.api_host+t.bargainData.goods.img2_id,alt:""}})]),n("div",{staticClass:"tit-wrap"},[n("span",{staticClass:"tit"},[t._v(t._s(t.bargainData.goods.goods_name))])]),n("div",{staticClass:"sharebtn",on:{click:t.share}},[t._v("召唤好友帮忙砍价")]),n("div",{staticClass:"des",domProps:{innerHTML:t._s(t.bargainData.goods.goods_desc)}}),n("div",{staticClass:"sharebtn",on:{click:t.share}},[t._v("召唤好友帮忙砍价")]),n("div",{staticClass:"price"},[t._v("原价:￥"+t._s(t.bargainData.goods.original_price))]),n("footer",[n("router-link",{attrs:{to:"/bargain/list"}},[t._v("活动商品")]),n("router-link",{attrs:{to:"/bargain/mybargain"}},[t._v("我的砍价")])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.guideShow,expression:"guideShow"}],attrs:{id:"mcover"},on:{click:t.hideCover}},[n("img",{attrs:{src:t.myconf.api_host+"/static/bargain/images/guide.png?v=1"}})])]):t._e()},q=[],M=(n("28a5"),n("18a0")),P=n.n(M),A={name:"GoodsDetail",data:function(){return{bargainData:{},images:{},configData:[],guideShow:!1}},created:function(){window.localStorage.getItem("iosurl")&&(window.localStorage.removeItem("iosurl"),window.location=window.location)},mounted:function(){this.getDetail()},methods:{getDetail:function(){var t=this,a=this.$route.query.no;y()({method:"GET",url:this.myconf.api_host+"/bargian_api/bargaindetail",params:{no:a}}).then(function(a){t.bargainData=a.data}).then(function(){t.getWxShareParams()}).catch(function(t){alert("用户身份校验失败，请刷新后再分享"+t)})},getWxShareParams:function(){var t=this,a=encodeURIComponent(window.location.href.split("#")[0]);y()({method:"get",url:this.myconf.api_host+"/bargian_api/wxshare",params:{currentUrl:a}}).then(function(a){var n=a.data;t.configData=n,t.wxInit(n)})},wxInit:function(t){var a=this.$route.query.no,n=window.location.protocol+"//"+window.location.host+"/bargain/login?flag=share&no="+a,e=this.bargainData.goods.goods_name,i="砍价活动进行中,快来帮帮TA砍一刀吧！",o=this.myconf.api_host+this.bargainData.goods.img1_id;P.a.config({debug:!1,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"]}),P.a.ready(function(){P.a.onMenuShareTimeline({title:e,desc:i,link:n,imgUrl:o,success:function(){alert("分享到朋友圈成功")},cancel:function(){alert("分享失败,您取消了分享!")}}),P.a.onMenuShareAppMessage({title:e,desc:i,link:n,imgUrl:o,success:function(){alert("成功分享给朋友")},cancel:function(){alert("分享失败,您取消了分享!")}})}),P.a.error(function(t){alert(t.errMsg+"用户身份校验失败，请刷新后再分享")})},share:function(){this.guideShow=!0},hideCover:function(){this.guideShow=!1}}},R=A,B=(n("db50"),Object(c["a"])(R,E,q,!1,null,"13bb5da4",null)),L=B.exports,U=function(){var t=this,a=t.$createElement,n=t._self._c||a;return t.bargainData.goods?n("div",{staticClass:"main"},[n("div",{staticClass:"banner"},[n("img",{attrs:{src:t.myconf.api_host+t.bargainData.goods.img2_id,alt:""}})]),n("div",{staticClass:"tit-wrap"},[n("span",{staticClass:"tit"},[t._v(t._s(t.bargainData.goods.goods_name))])]),n("div",{staticClass:"des",domProps:{innerHTML:t._s(t.bargainData.goods.goods_desc)}}),t.kjmoney?n("div",{staticClass:"bargian-monry"},[t._v("我帮TA砍了："+t._s(t.kjmoney)+"元")]):t._e(),n("div",{staticClass:"price"},[t._v("原价:￥"+t._s(t.bargainData.goods.original_price))]),n("footer",[n("div",{staticClass:"div",on:{click:t.meto}},[t._v("我也要参加")]),n("div",{staticClass:"sharebtn",on:{click:t.doBargain}},[t._v("帮TA砍一刀")])])]):t._e()},z=[],G={name:"Dobargain",data:function(){return{no:"",bargainData:{},bargainRresult:null,kjmoney:0}},created:function(){this.getBargain()},methods:{getBargain:function(){var t=this,a=this.$route.query.no;this.no=a;var n=window.localStorage.getItem(a);n&&(this.kjmoney=n),y()({method:"GET",url:this.myconf.api_host+"/bargian_api/bargaindetail",params:{no:a}}).then(function(a){var n=a.data;window.console.log(n),t.bargainData=n}).catch(function(a){alert(a.response.data.msg),t.$router.push({name:"list"})})},doBargain:function(){var t=this,a=this.no;y()({method:"POST",url:this.myconf.api_host+"/bargian_api/dobargain",headers:{Authorization:window.localStorage.getItem("user_token")},data:{no:a}}).then(function(n){var e=n.data;window.localStorage.setItem(a,e.kjmoney),t.kjmoney=e.kjmoney,alert("您成功帮你的好友砍了"+e.kjmoney+"元!")}).catch(function(a){var n=a.response.data.msg;"token已过期或无效token"==n?(window.localStorage.removeItem("user_token"),t.$router.push({name:"login",query:{flag:"share",no:t.no}})):"token已过期或无效token"!=n?alert(n):alert("发生错误")})},meto:function(){this.$router.push({name:"list"})}}},W=G,H=(n("af3d"),Object(c["a"])(W,U,z,!1,null,"7bda8ff9",null)),J=H.exports,N=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"main"},[n("ul",{staticClass:"list"},t._l(t.bargainOrdersData,function(a){return n("li",{key:a.id},[n("div",{staticClass:"goods-info"},[n("div",{staticClass:"pic"},[n("img",{attrs:{src:t.myconf.api_host+a.goods.img1_id,alt:""}})]),n("div",{staticClass:"info"},[n("p",{staticClass:"goods-name"},[t._v(t._s(a.goods.goods_name)),n("span",[t._v("(￥"+t._s(a.goods.original_price)+")")])]),n("div",{staticClass:"old-price"},[t._v("当前价：￥"+t._s(a.goods.original_price-a.helpers_sum))]),n("div",{staticClass:"order-sn"},[t._v("单号："+t._s(a.bargain_sn))]),n("div",[n("countdown",{attrs:{endtime:a.over_time}})],1),n("div",{staticClass:"btns"},[n("div",{staticClass:"link",on:{click:function(n){t.showRecord(a.bargain_sn)}}},[t._v("查看记录")]),new Date(a.over_time)-Date.parse(new Date)>0?n("router-link",{staticClass:"link",attrs:{to:{path:"/bargain/detail",query:{no:a.bargain_sn}}}},[t._v("继续砍价")]):n("div",{staticClass:"link over-link"},[t._v("当前砍价已结束")])],1)])]),n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowRecord==a.bargain_sn&&t.flag,expression:"isShowRecord==order.bargain_sn && flag"}],staticClass:"record"},[n("ul",t._l(a.helpers,function(a){return n("li",[n("img",{attrs:{src:a.user.headimgurl,alt:""}}),n("p",[t._v(t._s(a.user.nickname))]),n("span",[t._v(t._s(a.bargain_money)+"元")])])}))])])],1)})),n("footer",[n("router-link",{attrs:{to:"/bargain/list"}},[t._v("活动商品")]),n("router-link",{attrs:{to:"/bargain/mybargain"}},[t._v("我的砍价")])],1)])},F=[],K=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("span",{staticClass:"orange"},[t._v("倒计时:"+t._s(t.time))])},Q=[],V={data:function(){return{time:""}},props:["endtime"],mounted:function(){var t=this;this._interval=setInterval(function(){t.timeDown()},1e3)},destroyed:function(){clearInterval(this._interval)},methods:{timeDown:function(){var t=new Date(this.endtime)-Date.parse(new Date),a=parseInt(t/1e3/60/60/24),n=parseInt(t/1e3/60/60%24),e=parseInt(t/1e3/60%60),i=parseInt(t/1e3%60);n=n>9?n:"0"+n,e=e>9?e:"0"+e,i=i>9?i:"0"+i,this.time=a+"天"+n+"小时"+e+"分"+i+"秒"}}},X=V,Y=(n("76fd"),Object(c["a"])(X,K,Q,!1,null,"1e022bce",null)),Z=Y.exports,tt={name:"mybargain",components:{countdown:Z},data:function(){return{bargainOrdersData:{},istimeover:null,isShowRecord:!1,flag:!0}},created:function(){this.getBargainOrders(),this.istimeover=Date.parse(new Date(this.bargainOrdersData.overtime))-Date.parse(new Date)},methods:{getBargainOrders:function(){var t=this;y()({method:"GET",url:this.myconf.api_host+"/bargian_api/bargainorders",headers:{Authorization:window.localStorage.getItem("user_token")}}).then(function(a){var n=a.data;t.bargainOrdersData=n,window.console.log(n)}).catch(function(a){var n=a.response.data.msg;"token已过期或无效token"==n?(window.localStorage.removeItem("user_token"),t.$router.push({name:"login",query:{flag:"share",no:t.no}})):"token已过期或无效token"!=n?alert(n):alert("发生错误")})},showRecord:function(t){this.isShowRecord=t,this.flag=!this.flag}}},at=tt,nt=(n("23c1"),Object(c["a"])(at,N,F,!1,null,"706190bc",null)),et=nt.exports,it=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",[t._v("c")])},ot=[],rt={created:function(){window.localStorage.clear()}},st=rt,ct=(n("97ab"),Object(c["a"])(st,it,ot,!1,null,"3d6e69eb",null)),lt=ct.exports;e["a"].use(d["a"]);var ut=new d["a"]({mode:"history",routes:[{path:"/bargain/",component:v,meta:{title:"首页"}},{path:"/bargain/login",name:"login",component:D,meta:{title:"登录中..."}},{path:"/bargain/list",name:"list",component:T,meta:{title:"砍价商品列表"}},{path:"/bargain/detail",name:"detail",component:L,meta:{title:"分享砍价"}},{path:"/bargain/dobargain",name:"dobargain",component:J,meta:{title:"帮TA砍一刀吧！"}},{path:"/bargain/c",name:"c",component:lt,meta:{title:"c"}},{path:"/bargain/mybargain",name:"mybargain",component:et,meta:{title:"我的砍价单"}},{path:"*",component:T,meta:{title:"成都贝臣齿科"}}]});ut.beforeEach(function(t,a,n){var e=window.localStorage.getItem("user_token");return e||"/bargain/login"==t.path?(n(),e&&"/bargain/login"==t.path&&!t.query.flag||e&&"/bargain/"==t.path?(window.console.log("to.query",JSON.stringify(t.query)),n("/bargain/list"),!1):(document.title=t.meta.title,void n())):(n("/bargain/login"),!1)});var dt=ut,gt=(n("3aff"),{api_host:"https://bcwx.rehack.cn",appid:"wxc373be0ebd319f82"}),ft=gt;e["a"].config.productionTip=!1,e["a"].prototype.myconf=ft,new e["a"]({router:dt,render:function(t){return t(u)}}).$mount("#app")},"76fd":function(t,a,n){"use strict";var e=n("d8b1"),i=n.n(e);i.a},"897a":function(t,a,n){},"8af4":function(t,a,n){},"8b30":function(t,a,n){"use strict";var e=n("897a"),i=n.n(e);i.a},"97ab":function(t,a,n){"use strict";var e=n("8af4"),i=n.n(e);i.a},af3d:function(t,a,n){"use strict";var e=n("0970"),i=n.n(e);i.a},d8b1:function(t,a,n){},da41:function(t,a,n){"use strict";var e=n("e2a5"),i=n.n(e);i.a},db50:function(t,a,n){"use strict";var e=n("3478"),i=n.n(e);i.a},e2a5:function(t,a,n){},feef:function(t,a,n){}});
//# sourceMappingURL=app.65785ed9.js.map